---
title: "Module 1.3 Plotting"
author: "A. Gamble, I. Ali, N. Zaitlen"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
---

## Intro to Plotting
One of the most powerful features of R is it's functionality with data visualization 
and plotting. Various developers in the R community have created robust tools for data
visualization and plotting. Some plotting libraries are immensely extensive, allowing you
to create nearly any kind of plot you would like and more. 

The R developers community has created a variety of packages that are useful
for plotting. Base R has a highly customizable plotting function and is
used on occasion (see plot()). Searching forums is a great way to learn
about the ways you can customize features needed for your own data visualizatoin
approaches. See: https://www.r-bloggers.com/some-basics-for-base-graphics/
More recently, other plotting libraries have been developed and implemented
in various contexts (plotly, leaflet, pheatmap, etc). 

The most commonly used visualization tool in R is ggplot2 which has immense 
customizability and the most extensive documentation and instructional resources 
of the plotting libraries. ggplot2 is based on what is called the 'grammar of graphics'.
This is the idea that you can build nearly every graph from the same components: 
(1) a data set, (2) a coordinate system and (3) 'geoms' which are visual 
marks that represent data points. ggplot2 is able to create a diverse set 
of plots using these three characteristics. Here we will explore how to 
construct a few example plots using ggplot2. For a more exhaustive list 
of ggplot2 functions please review the ggplot2 cheat sheet linked here: 
https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf. 

It is worth fully exploring ggplot2 documentation. There are many 
customizable features for each geometry making ggplot2 one of the most 
comprehensive packages for data visualization in R. 

The art of data visualization requires both an understanding of the data that
you are working with and also an awareness of the important features of the 
data that you want to highlight. Experimenting with different visualization  
strategies can help you better pin down the most informative ways of displaying 
your data. When working with your own data it can be important to look at mean
or median values, the variance and spread, correlations and clusters.

Through our exercises in this session, we aim to highlight some of the more common
plots you might come across in your research. We will cover how to make these plots
using ggplot, or other relevant plotting libraries

## Setup
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2) # plotting library
library(ggExtra) # extra features for plotting library
library(dplyr) # data transformation
library(reshape2) # data transformation
library(RColorBrewer) # better color controls for plotting
```

## Data Import

Using the tools and strategies from Module1.1 and Module1.2 we created a data set
to simulate a time-course gene expression. Using read.csv() import the data to create
an obeject called "dummydata"

```{r dummydata}

dummydata <- read.csv("GeneExpressionData.csv", header = TRUE, sep = ",")

```

## Plotting One Variable

The most common plots when working with one variable include

```{r histogram}

# use geom_histogram to create a histogram to show the gene expression counts
# for all of the data.
ggplot(dummydata, aes(MeanCounts)) +
  geom_histogram(bins = 20) # set the number of bins to better visualize the data.


ggplot(dummydata, aes(MeanCounts, fill = GeneNames)) + 
  geom_histogram(binwidth = 10) # you can set give bins a fixed width

```

```{r dotplot}
ggplot(dummydata, aes(MeanCounts)) +
  geom_dotplot(dotsize = 0.5, binwidth = 10, method = "histodot")
```


## Adding lines to plot

We can take a look at how gene expression changes over time using line plots.

```{r plottinglines}
# Add a line across the mean of x from the value 1 to 50 on a plot of data x. 
# the rep function allows you to repeat a value a stated number of times
# rep(value, no_of_repetitions)

ggplot(dummydata, aes(TimePoint, MeanCounts, color = GeneNames)) +
  geom_line()

# Filter on one ore more genes in order to view individual genes on the plot
# 
gene15plot <- dummydata %>%
  filter(GeneNames == c("Gene01","Gene02","Gene03","Gene04","Gene05"))

ggplot(gene15plot, aes(TimePoint, MeanCounts, color = GeneNames)) +
  geom_line()

```

Dot plots are another useful way of visualizing each of the points in a trend


```{r addinglayers}
# add dots to your line plots for genes 5-10
gene510plot <- dummydata %>%
  filter(GeneNames == c("Gene06","Gene07","Gene08","Gene09","Gene10"))

ggplot(gene510plot, aes(TimePoint, MeanCounts, color = GeneNames)) +
  geom_line()+
  geom_point()

# plot genes 11-15 with smoothed lines (geom_smooth()) and show each data point
gene1115plot <- dummydata %>%
  filter(GeneNames == c("Gene11","Gene12","Gene13","Gene14","Gene15"))

ggplot(gene1115plot, aes(TimePoint, MeanCounts, color = GeneNames)) +
  geom_smooth(method = "auto")+
  geom_point()

# clean up the geom smooth plot by removing the confidence intervals
ggplot(gene1115plot, aes(TimePoint, MeanCounts, color = GeneNames)) +
  geom_smooth(method = "auto", se = F)+
  geom_point()

```


```{r plottinglinesfacets}
# separate genes 11 through 15 onto different plots and keep the confidence intervals

ggplot(gene1115plot, aes(TimePoint, MeanCounts, color = GeneNames)) +
  geom_smooth(method = "auto") + 
  geom_point()+
  facet_wrap(facets = "GeneNames")
```

Other plot types - the boxplot
```{r boxplot}
# Create a boxplot showing the distribution of gene expression for each gene
# across all time points.
ggplot(dummydata, aes(x = GeneNames, y = MeanCounts, fill = GeneNames))+
  geom_boxplot()

# Modify crowded x axis with theme(), hard to remember all the details?
# Look it up! "ggplot modify axis text" and you will find lots of tutorials
# you can modify text size, angle, justification, color, transparency
ggplot(dummydata, aes(x = GeneNames, y = MeanCounts, fill = GeneNames))+
  geom_boxplot()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


# Customize Axis Titles and Labels
ggplot(dummydata, aes(x = GeneNames, y = MeanCounts, fill = GeneNames))+
  geom_boxplot()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  labs(title = "Box Plots of Gene Counts",
       x = "Gene IDs",
       y = "Counts per Million")

```

Violin Plots
```{r}
ggplot(dummydata, aes(x = GeneNames, y = MeanCounts, fill = GeneNames))+
  geom_violin(scale = "width")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  labs(title = "Box Plots of Gene Counts",
       x = "Gene IDs",
       y = "Counts per Million")

ggplot(dummydata, aes(x = GeneNames, y = MeanCounts, fill = GeneNames))+
  geom_violin(scale = "width")+
  geom_dotplot(binaxis = "y", stackdir = "center", fill = "black", color = "white", dotsize = 0.7)+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  labs(title = "Box Plots of Gene Counts",
       x = "Gene IDs",
       y = "Counts per Million")

```

Modifying Colors

Bar Plot
```{r}

```

Heatmap
```{r}

```

